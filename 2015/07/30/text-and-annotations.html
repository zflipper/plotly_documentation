<h1>Text and Annotations in R | Examples | Plotly</h1>

<h1>Adding Text and Annotations in R</h1>

<h3>Text Mode</h3>
<div class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">library</span><span class="p">(</span><span class="n">plotly</span><span class="p">)</span>
<span class="n">plot_ly</span><span class="p">(</span><span class="n">mtcars</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="o">~</span><span class="n">wt</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="o">~</span><span class="n">mpg</span><span class="p">,</span> <span class="n">text</span> <span class="o">=</span> <span class="n">rownames</span><span class="p">(</span><span class="n">mtcars</span><span class="p">))</span> <span class="o">%&gt;%</span>
  <span class="n">add_text</span><span class="p">()</span>
</code></pre></div>
<h3>Hover Text</h3>
<div class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">plot_ly</span><span class="p">(</span><span class="n">mtcars</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="o">~</span><span class="n">wt</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="o">~</span><span class="n">mpg</span><span class="p">,</span> <span class="n">text</span> <span class="o">=</span> <span class="n">rownames</span><span class="p">(</span><span class="n">mtcars</span><span class="p">))</span> <span class="o">%&gt;%</span>
  <span class="n">add_markers</span><span class="p">()</span>
</code></pre></div>
<h3>Styling Text</h3>
<div class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">t</span> <span class="o">&lt;-</span> <span class="n">list</span><span class="p">(</span>
  <span class="n">family</span> <span class="o">=</span> <span class="s2">"sans serif"</span><span class="p">,</span>
  <span class="n">size</span> <span class="o">=</span> <span class="m">18</span><span class="p">,</span>
  <span class="n">color</span> <span class="o">=</span> <span class="n">toRGB</span><span class="p">(</span><span class="s2">"grey50"</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">plot_ly</span><span class="p">(</span><span class="n">mtcars</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="o">~</span><span class="n">wt</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="o">~</span><span class="n">mpg</span><span class="p">,</span> <span class="n">text</span> <span class="o">=</span> <span class="n">rownames</span><span class="p">(</span><span class="n">mtcars</span><span class="p">))</span> <span class="o">%&gt;%</span>
  <span class="n">add_markers</span><span class="p">()</span> <span class="o">%&gt;%</span>
  <span class="n">add_text</span><span class="p">(</span><span class="n">textfont</span> <span class="o">=</span> <span class="n">t</span><span class="p">,</span> <span class="n">textposition</span> <span class="o">=</span> <span class="s2">"top middle"</span><span class="p">)</span>
</code></pre></div>
<h3>Single Annotation</h3>
<div class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">m</span> <span class="o">&lt;-</span> <span class="n">mtcars</span><span class="p">[</span><span class="n">which.max</span><span class="p">(</span><span class="n">mtcars</span><span class="o">$</span><span class="n">mpg</span><span class="p">),</span> <span class="p">]</span>

<span class="n">a</span> <span class="o">&lt;-</span> <span class="n">list</span><span class="p">(</span>
  <span class="n">x</span> <span class="o">=</span> <span class="n">m</span><span class="o">$</span><span class="n">wt</span><span class="p">,</span>
  <span class="n">y</span> <span class="o">=</span> <span class="n">m</span><span class="o">$</span><span class="n">mpg</span><span class="p">,</span>
  <span class="n">text</span> <span class="o">=</span> <span class="n">rownames</span><span class="p">(</span><span class="n">m</span><span class="p">),</span>
  <span class="n">xref</span> <span class="o">=</span> <span class="s2">"x"</span><span class="p">,</span>
  <span class="n">yref</span> <span class="o">=</span> <span class="s2">"y"</span><span class="p">,</span>
  <span class="n">showarrow</span> <span class="o">=</span> <span class="n">TRUE</span><span class="p">,</span>
  <span class="n">arrowhead</span> <span class="o">=</span> <span class="m">7</span><span class="p">,</span>
  <span class="n">ax</span> <span class="o">=</span> <span class="m">20</span><span class="p">,</span>
  <span class="n">ay</span> <span class="o">=</span> <span class="m">-40</span>
<span class="p">)</span>

<span class="n">plot_ly</span><span class="p">(</span><span class="n">mtcars</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="o">~</span><span class="n">wt</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="o">~</span><span class="n">mpg</span><span class="p">)</span> <span class="o">%&gt;%</span>
  <span class="n">add_markers</span><span class="p">()</span> <span class="o">%&gt;%</span>
  <span class="n">layout</span><span class="p">(</span><span class="n">annotations</span> <span class="o">=</span> <span class="n">a</span><span class="p">)</span>
</code></pre></div>
<h3>Multiple Annotations</h3>
<div class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">a</span> <span class="o">&lt;-</span> <span class="n">list</span><span class="p">()</span>
<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="k">in</span> <span class="n">seq_len</span><span class="p">(</span><span class="n">nrow</span><span class="p">(</span><span class="n">mtcars</span><span class="p">)))</span> <span class="p">{</span>
  <span class="n">m</span> <span class="o">&lt;-</span> <span class="n">mtcars</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">]</span>
  <span class="n">a</span><span class="p">[[</span><span class="n">i</span><span class="p">]]</span> <span class="o">&lt;-</span> <span class="n">list</span><span class="p">(</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">m</span><span class="o">$</span><span class="n">wt</span><span class="p">,</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">m</span><span class="o">$</span><span class="n">mpg</span><span class="p">,</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">rownames</span><span class="p">(</span><span class="n">m</span><span class="p">),</span>
    <span class="n">xref</span> <span class="o">=</span> <span class="s2">"x"</span><span class="p">,</span>
    <span class="n">yref</span> <span class="o">=</span> <span class="s2">"y"</span><span class="p">,</span>
    <span class="n">showarrow</span> <span class="o">=</span> <span class="n">TRUE</span><span class="p">,</span>
    <span class="n">arrowhead</span> <span class="o">=</span> <span class="m">7</span><span class="p">,</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="m">20</span><span class="p">,</span>
    <span class="n">ay</span> <span class="o">=</span> <span class="m">-40</span>
  <span class="p">)</span>
<span class="p">}</span>

<span class="n">plot_ly</span><span class="p">(</span><span class="n">mtcars</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="o">~</span><span class="n">wt</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="o">~</span><span class="n">mpg</span><span class="p">)</span> <span class="o">%&gt;%</span>
  <span class="n">add_markers</span><span class="p">()</span> <span class="o">%&gt;%</span>
  <span class="n">layout</span><span class="p">(</span><span class="n">annotations</span> <span class="o">=</span> <span class="n">a</span><span class="p">)</span>
</code></pre></div>
<h3>Custom Hover Text</h3>
<div class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">mtcars</span> <span class="o">%&gt;%</span> 
  <span class="n">plot_ly</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="o">~</span><span class="n">disp</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="o">~</span><span class="n">mpg</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="o">~</span><span class="n">factor</span><span class="p">(</span><span class="n">cyl</span><span class="p">),</span> <span class="n">size</span> <span class="o">=</span> <span class="o">~</span><span class="n">wt</span><span class="p">)</span> <span class="o">%&gt;%</span>
  <span class="n">add_markers</span><span class="p">(</span>
    <span class="n">hoverinfo</span> <span class="o">=</span> <span class="s2">"text"</span><span class="p">,</span>
    <span class="n">text</span> <span class="o">=</span> <span class="o">~</span><span class="n">paste</span><span class="p">(</span><span class="s2">"Displacement = "</span><span class="p">,</span> <span class="n">disp</span><span class="p">,</span> <span class="s2">"Miles Per Gallon = "</span><span class="p">,</span> <span class="n">mpg</span><span class="p">)</span>
  <span class="p">)</span> <span class="o">%&gt;%</span> 
  <span class="n">layout</span><span class="p">(</span><span class="n">title</span> <span class="o">=</span><span class="s2">"Custom Hover Text"</span><span class="p">)</span>
</code></pre></div>