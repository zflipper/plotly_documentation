<h1>Bubble Maps in R | Examples | Plotly</h1>

<h3>New to Plotly?</h3>

<p>Plotly&#39;s R library is free and open source!<br>
<a href="https://plot.ly/r/getting-started/">Get started</a> by downloading the client and <a href="https://plot.ly/r/getting-started/">reading the primer</a>.<br>
You can set up Plotly to work in <a href="https://plot.ly/r/getting-started/#hosting-graphs-in-your-online-plotly-account">online</a> or <a href="https://plot.ly/r/offline/">offline</a> mode.<br>
We also have a quick-reference <a href="https://images.plot.ly/plotly-documentation/images/r_cheat_sheet.pdf">cheatsheet</a> (new!) to help you get started!</p>

<h3>Version Check</h3>

<p>Version 4 of Plotly&#39;s R package is now <a href="https://plot.ly/r/getting-started/#installation">available</a>!<br>
Check out <a href="http://moderndata.plot.ly/upgrading-to-plotly-4-0-and-above/">this post</a> for more information on breaking changes and new features available in this version.</p>
<div class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">library</span><span class="p">(</span><span class="n">plotly</span><span class="p">)</span>
<span class="n">packageVersion</span><span class="p">(</span><span class="s1">'plotly'</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre><code class="language-" data-lang="">## [1] '4.5.2'
</code></pre></div>
<h4>United States Bubble Map</h4>
<div class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">library</span><span class="p">(</span><span class="n">plotly</span><span class="p">)</span>
<span class="n">df</span> <span class="o">&lt;-</span> <span class="n">read.csv</span><span class="p">(</span><span class="s1">'https://raw.githubusercontent.com/plotly/datasets/master/2014_us_cities.csv'</span><span class="p">)</span>

<span class="n">df</span><span class="o">$</span><span class="n">q</span> <span class="o">&lt;-</span> <span class="n">with</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">cut</span><span class="p">(</span><span class="n">pop</span><span class="p">,</span> <span class="n">quantile</span><span class="p">(</span><span class="n">pop</span><span class="p">)))</span>
<span class="n">levels</span><span class="p">(</span><span class="n">df</span><span class="o">$</span><span class="n">q</span><span class="p">)</span> <span class="o">&lt;-</span> <span class="n">paste</span><span class="p">(</span><span class="n">c</span><span class="p">(</span><span class="s2">"1st"</span><span class="p">,</span> <span class="s2">"2nd"</span><span class="p">,</span> <span class="s2">"3rd"</span><span class="p">,</span> <span class="s2">"4th"</span><span class="p">,</span> <span class="s2">"5th"</span><span class="p">),</span> <span class="s2">"Quantile"</span><span class="p">)</span>
<span class="n">df</span><span class="o">$</span><span class="n">q</span> <span class="o">&lt;-</span> <span class="n">as.ordered</span><span class="p">(</span><span class="n">df</span><span class="o">$</span><span class="n">q</span><span class="p">)</span>

<span class="n">g</span> <span class="o">&lt;-</span> <span class="n">list</span><span class="p">(</span>
  <span class="n">scope</span> <span class="o">=</span> <span class="s1">'usa'</span><span class="p">,</span>
  <span class="n">projection</span> <span class="o">=</span> <span class="n">list</span><span class="p">(</span><span class="n">type</span> <span class="o">=</span> <span class="s1">'albers usa'</span><span class="p">),</span>
  <span class="n">showland</span> <span class="o">=</span> <span class="n">TRUE</span><span class="p">,</span>
  <span class="n">landcolor</span> <span class="o">=</span> <span class="n">toRGB</span><span class="p">(</span><span class="s2">"gray85"</span><span class="p">),</span>
  <span class="n">subunitwidth</span> <span class="o">=</span> <span class="m">1</span><span class="p">,</span>
  <span class="n">countrywidth</span> <span class="o">=</span> <span class="m">1</span><span class="p">,</span>
  <span class="n">subunitcolor</span> <span class="o">=</span> <span class="n">toRGB</span><span class="p">(</span><span class="s2">"white"</span><span class="p">),</span>
  <span class="n">countrycolor</span> <span class="o">=</span> <span class="n">toRGB</span><span class="p">(</span><span class="s2">"white"</span><span class="p">)</span>
<span class="p">)</span>

<span class="n">plot_geo</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">locationmode</span> <span class="o">=</span> <span class="s1">'USA-states'</span><span class="p">,</span> <span class="n">sizes</span> <span class="o">=</span> <span class="n">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">250</span><span class="p">))</span> <span class="o">%&gt;%</span>
  <span class="n">add_markers</span><span class="p">(</span>
    <span class="n">x</span> <span class="o">=</span> <span class="o">~</span><span class="n">lon</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="o">~</span><span class="n">lat</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="o">~</span><span class="n">pop</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="o">~</span><span class="n">q</span><span class="p">,</span> <span class="n">hoverinfo</span> <span class="o">=</span> <span class="s2">"text"</span><span class="p">,</span>
    <span class="n">text</span> <span class="o">=</span> <span class="o">~</span><span class="n">paste</span><span class="p">(</span><span class="n">df</span><span class="o">$</span><span class="n">name</span><span class="p">,</span> <span class="s2">"&lt;br /&gt;"</span><span class="p">,</span> <span class="n">df</span><span class="o">$</span><span class="n">pop</span><span class="o">/</span><span class="m">1e6</span><span class="p">,</span> <span class="s2">" million"</span><span class="p">)</span>
  <span class="p">)</span> <span class="o">%&gt;%</span>
  <span class="n">layout</span><span class="p">(</span><span class="n">title</span> <span class="o">=</span> <span class="s1">'2014 US city populations&lt;br&gt;(Click legend to toggle)'</span><span class="p">,</span> <span class="n">geo</span> <span class="o">=</span> <span class="n">g</span><span class="p">)</span>
</code></pre></div>
<iframe src="https://plot.ly/~RPlotBot/3105.embed" width="800" height="600" id="igraph" scrolling="no" seamless="seamless" frameBorder="0"> </iframe>
