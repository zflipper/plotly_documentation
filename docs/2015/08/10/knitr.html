<h1>Using Plotly with rmarkdown/knitr</h1>

<h2>Embedding plotly graphs in Rmd files</h2>

<p>If you are using <a href="http://rmarkdown.rstudio.com/">rmarkdown</a> with HTML output, printing a <code>plotly</code> object in a code chunk will result in an interactive HTML graph. When using rmarkdown with non-HTML output, printing a <code>plotly</code> object will result in a png screenshot of the graph.</p>
<div class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">library</span><span class="p">(</span><span class="n">plotly</span><span class="p">)</span><span class="w">
</span><span class="n">p</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">plot_ly</span><span class="p">(</span><span class="n">economics</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">~</span><span class="n">date</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">~</span><span class="n">unemploy</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">pop</span><span class="p">)</span><span class="w">
</span><span class="n">p</span><span class="w">
</span></code></pre></div>
<iframe src="https://plot.ly/~RPlotBot/1286.embed" width="800" height="600" id="igraph" scrolling="no" seamless="seamless" frameBorder="0"> </iframe>

<p>Sometimes, you may want to print a <em>list</em> of plotly objects. If, for some reason, you don&#39;t want to use the <a href="https://plot.ly/r/subplots/"><code>subplot()</code> function</a>, you can print a list of htmlwidgets in a single code chunk using the <code>tagList()</code> function from the <strong>htmltools</strong> package:</p>
<div class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">htmltools</span><span class="o">::</span><span class="n">tagList</span><span class="p">(</span><span class="nf">list</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">))</span><span class="w">
</span></code></pre></div>
<p>You can also host your figures on a plotly server via <code>plotly_POST()</code> which returns a figure object. When a figure object is printed in an rmarkdown/knitr document, it embeds the figure as an iframe, displaying the plot as it appears on your plotly account.</p>
<div class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">f</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">plotly_POST</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="w">
</span><span class="nf">class</span><span class="p">(</span><span class="n">f</span><span class="p">)</span><span class="w">
</span><span class="n">f</span><span class="w">
</span></code></pre></div>
<p>You can control the height/width of that iframe through the <code>height</code>/<code>width</code> <a href="http://yihui.name/knitr/options/">knitr chunk options</a>, but the figure object also contains the relevant url so you complete control over embedding your figure. The post has more details on how to <a href="http://help.plot.ly/embed-graphs-in-websites/">embed plotly graphs with HTML iframes</a>, but could also use plotly&#39;s built-in image export by simply adding a <code>.png</code> (or similar) extension.</p>
<div class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">htmltools</span><span class="o">::</span><span class="n">tags</span><span class="o">$</span><span class="n">img</span><span class="p">(</span><span class="n">src</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">paste0</span><span class="p">(</span><span class="n">f</span><span class="p">[[</span><span class="s2">"url"</span><span class="p">]],</span><span class="w"> </span><span class="s2">".png"</span><span class="p">))</span><span class="w">
</span></code></pre></div>
<p>&lt;!--html<em>preserve--&gt;<img src="https://plot.ly/~RPlotBot/3329.png"/>&lt;!--/html</em>preserve--&gt;</p>
