<h1>Coupled events with Shiny and Plotly | Examples | Plotly</h1>

<h1>Coupled Events in Plotly using Shiny</h1>

<p>Plotly supports two separate <strong>click events</strong> that can be used to read user inputs using the <code>event_data()</code> function.</p>

<ul>
<li><code>plotly_selected</code> can be used to return information about data points inside a selection box (<em>box</em> or <em>lasso</em>)</li>
<li><code>plotly_click</code> can be used to return information about a single data point</li>
</ul>

<p>Information returned is of the following form: </p>

<ul>
<li><code>x</code> coordinate</li>
<li><code>y</code> coordinate</li>
<li><code>curveNumber</code>: for mutiple traces, information will be returned in a <em>stacked</em> fashion</li>
<li><code>pointNumber</code>: Index of the data point being charted. <strong>Note</strong> that this is linked to <code>curveNumber</code> and starts from <code>0</code></li>
</ul>

<p>Below is an example on how to couple events from multiple charts together in the same app. The <code>source</code> argument is used to bind an <code>event_data()</code> command to a specific plotly graph.</p>

<h2>Shiny app</h2>

<iframe src="https://plotly.shinyapps.io/ShinyCoupledEvents/" width="100%" height=1600 scrolling="no" seamless="seamless" style="border: none"></iframe>

<h2>Code</h2>

<h3>ui.r</h3>
<div class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">library</span><span class="p">(</span><span class="n">shiny</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">mlbench</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">plotly</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">shinythemes</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">dplyr</span><span class="p">)</span><span class="w">

</span><span class="c1"># Load data
</span><span class="n">data</span><span class="p">(</span><span class="n">BreastCancer</span><span class="p">)</span><span class="w">

</span><span class="c1"># Remove NAs
</span><span class="n">BreastCancer</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">na.omit</span><span class="p">(</span><span class="n">BreastCancer</span><span class="p">)</span><span class="w">

</span><span class="c1"># Remvove ID
</span><span class="n">BreastCancer</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">BreastCancer</span><span class="p">[,</span><span class="m">-1</span><span class="p">]</span><span class="w">

</span><span class="c1"># Store features and actual class in seprate variables
</span><span class="n">featureList</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">colnames</span><span class="p">(</span><span class="n">BreastCancer</span><span class="p">)[</span><span class="m">-10</span><span class="p">]</span><span class="w">
</span><span class="n">class</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">BreastCancer</span><span class="o">$</span><span class="n">Class</span><span class="w">

</span><span class="c1"># Convert to numeric
</span><span class="n">BreastCancer</span><span class="p">[,</span><span class="m">1</span><span class="o">:</span><span class="m">9</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">apply</span><span class="p">(</span><span class="n">BreastCancer</span><span class="p">[,</span><span class="m">-10</span><span class="p">],</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">as.numeric</span><span class="p">)</span><span class="w">

</span><span class="c1"># ui.R definition
</span><span class="n">ui</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">fluidPage</span><span class="p">(</span><span class="w">
  </span><span class="c1"># Set theme
</span><span class="w">  </span><span class="n">theme</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">shinytheme</span><span class="p">(</span><span class="s2">"spacelab"</span><span class="p">),</span><span class="w">

  </span><span class="c1"># Some help text
</span><span class="w">  </span><span class="n">h</span><span class="m">2</span><span class="p">(</span><span class="s2">"Coupled events in plotly charts using Shiny"</span><span class="p">),</span><span class="w">
  </span><span class="n">h</span><span class="m">4</span><span class="p">(</span><span class="s2">"This Shiny app showcases coupled events using Plotly's "</span><span class="p">,</span><span class="w"> </span><span class="n">tags</span><span class="o">$</span><span class="n">code</span><span class="p">(</span><span class="s2">"event_data()"</span><span class="p">),</span><span class="w"> </span><span class="s2">" function."</span><span class="p">),</span><span class="w">
  </span><span class="n">tags</span><span class="o">$</span><span class="n">ol</span><span class="p">(</span><span class="w">
    </span><span class="n">tags</span><span class="o">$</span><span class="n">li</span><span class="p">(</span><span class="s2">"The first chart showcases"</span><span class="p">,</span><span class="w"> </span><span class="n">tags</span><span class="o">$</span><span class="n">code</span><span class="p">(</span><span class="s2">"plotly_selected"</span><span class="p">)),</span><span class="w">
    </span><span class="n">tags</span><span class="o">$</span><span class="n">li</span><span class="p">(</span><span class="s2">"The third chart showcases"</span><span class="p">,</span><span class="w"> </span><span class="n">tags</span><span class="o">$</span><span class="n">code</span><span class="p">(</span><span class="s2">"plotly_click"</span><span class="p">))</span><span class="w">
  </span><span class="p">),</span><span class="w">

  </span><span class="c1"># Vertical space
</span><span class="w">  </span><span class="n">tags</span><span class="o">$</span><span class="n">hr</span><span class="p">(),</span><span class="w">

  </span><span class="c1"># Feature selection
</span><span class="w">  </span><span class="n">fixedRow</span><span class="p">(</span><span class="w">
    </span><span class="n">column</span><span class="p">(</span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="n">selectInput</span><span class="p">(</span><span class="n">inputId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"featureInput1"</span><span class="p">,</span><span class="w"> </span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Select first feature"</span><span class="p">,</span><span class="w"> </span><span class="n">choices</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">featureList</span><span class="p">,</span><span class="w"> </span><span class="n">selected</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Cell.Size"</span><span class="p">)),</span><span class="w">
    </span><span class="n">column</span><span class="p">(</span><span class="m">4</span><span class="p">,</span><span class="w"> </span><span class="n">selectInput</span><span class="p">(</span><span class="n">inputId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"featureInput2"</span><span class="p">,</span><span class="w"> </span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Select second feature (observed event)"</span><span class="p">,</span><span class="w"> </span><span class="n">choices</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">featureList</span><span class="p">,</span><span class="w"> </span><span class="n">selected</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Epith.c.size"</span><span class="p">))),</span><span class="w">

  </span><span class="c1"># First row
</span><span class="w">  </span><span class="n">fixedRow</span><span class="p">(</span><span class="w">
    </span><span class="n">column</span><span class="p">(</span><span class="m">6</span><span class="p">,</span><span class="w"> </span><span class="n">plotlyOutput</span><span class="p">(</span><span class="s2">"Plot1"</span><span class="p">,</span><span class="w"> </span><span class="n">height</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"600px"</span><span class="p">)),</span><span class="w">
    </span><span class="n">column</span><span class="p">(</span><span class="m">6</span><span class="p">,</span><span class="w"> </span><span class="n">plotlyOutput</span><span class="p">(</span><span class="s2">"Plot2"</span><span class="p">,</span><span class="w"> </span><span class="n">height</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"600px"</span><span class="p">))),</span><span class="w">

  </span><span class="n">tags</span><span class="o">$</span><span class="n">hr</span><span class="p">(),</span><span class="w">
  </span><span class="n">tags</span><span class="o">$</span><span class="n">blockquote</span><span class="p">(</span><span class="s2">"First drag a selection box in the scatter plot to populate the barchart. Then select one of the bars in the barchat
    to populate the boxplot"</span><span class="p">),</span><span class="w">


  </span><span class="c1"># Second row
</span><span class="w">  </span><span class="n">fixedRow</span><span class="p">(</span><span class="w">
    </span><span class="n">column</span><span class="p">(</span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="n">plotlyOutput</span><span class="p">(</span><span class="s2">"Plot3"</span><span class="p">,</span><span class="w"> </span><span class="n">height</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"600px"</span><span class="p">)),</span><span class="w">
    </span><span class="n">column</span><span class="p">(</span><span class="m">9</span><span class="p">,</span><span class="w"> </span><span class="n">plotlyOutput</span><span class="p">(</span><span class="s2">"Plot4"</span><span class="p">,</span><span class="w"> </span><span class="n">height</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"600px"</span><span class="p">))))</span><span class="w">
</span></code></pre></div>
<h3>server.r</h3>
<div class="highlight"><pre><code class="language-r" data-lang="r"><span class="c1"># server.R definition
</span><span class="n">server</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">input</span><span class="p">,</span><span class="w"> </span><span class="n">output</span><span class="p">){</span><span class="w">

  </span><span class="c1"># Observes the second feature input for a change
</span><span class="w">  </span><span class="n">observeEvent</span><span class="p">(</span><span class="n">input</span><span class="o">$</span><span class="n">featureInput2</span><span class="p">,{</span><span class="w">

    </span><span class="c1"># Create a convenience data.frame which can be used for charting
</span><span class="w">    </span><span class="n">plot.df</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">data.frame</span><span class="p">(</span><span class="n">BreastCancer</span><span class="p">[,</span><span class="n">input</span><span class="o">$</span><span class="n">featureInput1</span><span class="p">],</span><span class="w">
                          </span><span class="n">BreastCancer</span><span class="p">[,</span><span class="n">input</span><span class="o">$</span><span class="n">featureInput2</span><span class="p">],</span><span class="w">
                          </span><span class="n">Class</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BreastCancer</span><span class="o">$</span><span class="n">Class</span><span class="p">)</span><span class="w">

    </span><span class="c1"># Add column names
</span><span class="w">    </span><span class="n">colnames</span><span class="p">(</span><span class="n">plot.df</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"x"</span><span class="p">,</span><span class="w"> </span><span class="s2">"y"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Class"</span><span class="p">)</span><span class="w">

    </span><span class="c1"># Do a plotly contour plot to visualize the two featres with
</span><span class="w">    </span><span class="c1"># the number of malignant cases as size
</span><span class="w">    </span><span class="c1"># Note the use of 'source' argument
</span><span class="w">    </span><span class="n">output</span><span class="o">$</span><span class="n">Plot1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">renderPlotly</span><span class="p">({</span><span class="w">
      </span><span class="n">plot_ly</span><span class="p">(</span><span class="n">plot.df</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">~</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">~</span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">mode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"markers"</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"scatter"</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">~</span><span class="n">Class</span><span class="p">,</span><span class="w"> </span><span class="n">source</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"subset"</span><span class="p">,</span><span class="w">
              </span><span class="n">marker</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">list</span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">30</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
        </span><span class="n">layout</span><span class="p">(</span><span class="n">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">paste</span><span class="p">(</span><span class="n">input</span><span class="o">$</span><span class="n">featureInput1</span><span class="p">,</span><span class="w"> </span><span class="s2">"vs "</span><span class="p">,</span><span class="w"> </span><span class="n">input</span><span class="o">$</span><span class="n">featureInput2</span><span class="p">),</span><span class="w">
               </span><span class="n">xaxis</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">list</span><span class="p">(</span><span class="n">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">input</span><span class="o">$</span><span class="n">featureInput1</span><span class="p">),</span><span class="w">
               </span><span class="n">yaxis</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">list</span><span class="p">(</span><span class="n">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">input</span><span class="o">$</span><span class="n">featureInput2</span><span class="p">),</span><span class="w">
               </span><span class="n">dragmode</span><span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="s2">"select"</span><span class="p">,</span><span class="w">
               </span><span class="n">plot_bgcolor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"6A446F"</span><span class="p">)</span><span class="w">
    </span><span class="p">})</span><span class="w">


    </span><span class="c1"># Create a contour plot of the number of malignant cases
</span><span class="w">    </span><span class="n">output</span><span class="o">$</span><span class="n">Plot2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">renderPlotly</span><span class="p">({</span><span class="w">

      </span><span class="n">plot.df</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
        </span><span class="n">group_by</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">Class</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
        </span><span class="n">summarize</span><span class="p">(</span><span class="n">Count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span><span class="p">())</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
        </span><span class="n">filter</span><span class="p">(</span><span class="n">Class</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"malignant"</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
        </span><span class="n">plot_ly</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">~</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">~</span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">~</span><span class="n">Count</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"contour"</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
        </span><span class="n">layout</span><span class="p">(</span><span class="n">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Contour map of number of malignant cases"</span><span class="p">,</span><span class="w">
               </span><span class="n">xaxis</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">list</span><span class="p">(</span><span class="n">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">input</span><span class="o">$</span><span class="n">featureInput1</span><span class="p">),</span><span class="w">
               </span><span class="n">yaxis</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">list</span><span class="p">(</span><span class="n">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">input</span><span class="o">$</span><span class="n">featureInput2</span><span class="p">))</span><span class="w">

    </span><span class="p">})</span><span class="w">

    </span><span class="c1"># Assign to parent environment
</span><span class="w">    </span><span class="n">plot.df</span><span class="w"> </span><span class="o">&lt;&lt;-</span><span class="w"> </span><span class="n">plot.df</span><span class="w">
  </span><span class="p">})</span><span class="w">

  </span><span class="c1"># Coupled event 1
</span><span class="w">  </span><span class="n">output</span><span class="o">$</span><span class="n">Plot3</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">renderPlotly</span><span class="p">({</span><span class="w">

    </span><span class="c1"># Get subset based on selection
</span><span class="w">    </span><span class="n">event.data</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">event_data</span><span class="p">(</span><span class="s2">"plotly_selected"</span><span class="p">,</span><span class="w"> </span><span class="n">source</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"subset"</span><span class="p">)</span><span class="w">

    </span><span class="c1"># If NULL dont do anything
</span><span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="nf">is.null</span><span class="p">(</span><span class="n">event.data</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">T</span><span class="p">)</span><span class="w"> </span><span class="nf">return</span><span class="p">(</span><span class="kc">NULL</span><span class="p">)</span><span class="w">

    </span><span class="c1"># Get number of malignant and benign cases from selection
</span><span class="w">    </span><span class="n">malig.class</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">subset</span><span class="p">(</span><span class="n">plot.df</span><span class="p">,</span><span class="w"> </span><span class="n">Class</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"malignant"</span><span class="p">)[</span><span class="n">subset</span><span class="p">(</span><span class="n">event.data</span><span class="p">,</span><span class="w"> </span><span class="n">curveNumber</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">0</span><span class="p">)</span><span class="o">$</span><span class="n">pointNumber</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="m">1</span><span class="p">,]</span><span class="w">
    </span><span class="n">benign.class</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">subset</span><span class="p">(</span><span class="n">plot.df</span><span class="p">,</span><span class="w"> </span><span class="n">Class</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"benign"</span><span class="p">)[</span><span class="n">subset</span><span class="p">(</span><span class="n">event.data</span><span class="p">,</span><span class="w"> </span><span class="n">curveNumber</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="p">)</span><span class="o">$</span><span class="n">pointNumber</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="m">1</span><span class="p">,]</span><span class="w">

    </span><span class="c1"># Combine
</span><span class="w">    </span><span class="n">plot.subset</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">rbind</span><span class="p">(</span><span class="n">malig.class</span><span class="p">,</span><span class="w"> </span><span class="n">benign.class</span><span class="p">)</span><span class="w">

    </span><span class="c1"># Summarize
</span><span class="w">    </span><span class="n">plot.summ</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">plot.subset</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
      </span><span class="n">group_by</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">Class</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
      </span><span class="n">summarize</span><span class="p">(</span><span class="n">Count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span><span class="p">())</span><span class="w">

    </span><span class="c1"># Assign to parent frame
</span><span class="w">    </span><span class="n">plot.summ</span><span class="w"> </span><span class="o">&lt;&lt;-</span><span class="w"> </span><span class="n">plot.summ</span><span class="w">


    </span><span class="c1"># Plot
</span><span class="w">    </span><span class="n">plot_ly</span><span class="p">(</span><span class="n">plot.summ</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">~</span><span class="n">Class</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">~</span><span class="n">Count</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"bar"</span><span class="p">,</span><span class="w"> </span><span class="n">source</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"select"</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">~</span><span class="n">Class</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
      </span><span class="n">layout</span><span class="p">(</span><span class="n">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"No. of Malignant and Benign cases &lt;br&gt; in Selection"</span><span class="p">,</span><span class="w">
             </span><span class="n">plot_bgcolor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"6A446F"</span><span class="p">,</span><span class="w">
             </span><span class="n">yaxis</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">list</span><span class="p">(</span><span class="n">domain</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">0.9</span><span class="p">)))</span><span class="w">
  </span><span class="p">})</span><span class="w">

  </span><span class="c1"># Coupled event 2
</span><span class="w">  </span><span class="n">output</span><span class="o">$</span><span class="n">Plot4</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">renderPlotly</span><span class="p">({</span><span class="w">

    </span><span class="c1"># Get subset based on selection
</span><span class="w">    </span><span class="n">event.data</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">event_data</span><span class="p">(</span><span class="s2">"plotly_click"</span><span class="p">,</span><span class="w"> </span><span class="n">source</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"select"</span><span class="p">)</span><span class="w">

    </span><span class="c1"># If NULL dont do anything
</span><span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="nf">is.null</span><span class="p">(</span><span class="n">event.data</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">T</span><span class="p">)</span><span class="w"> </span><span class="nf">return</span><span class="p">(</span><span class="kc">NULL</span><span class="p">)</span><span class="w">


    </span><span class="c1"># If Malignant
</span><span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">event.data</span><span class="p">[</span><span class="m">3</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"malignant"</span><span class="p">){</span><span class="w">

      </span><span class="n">tab</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">subset</span><span class="p">(</span><span class="n">plot.summ</span><span class="p">,</span><span class="w"> </span><span class="n">Class</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"malignant"</span><span class="p">)</span><span class="w">

      </span><span class="n">p</span><span class="m">1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">plot_ly</span><span class="p">(</span><span class="n">tab</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Count</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"box"</span><span class="p">,</span><span class="w"> </span><span class="n">showlegend</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">F</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
        </span><span class="n">layout</span><span class="p">(</span><span class="n">yaxis</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">list</span><span class="p">(</span><span class="n">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Count"</span><span class="p">),</span><span class="w">
               </span><span class="n">xaxis</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">list</span><span class="p">(</span><span class="n">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">input</span><span class="o">$</span><span class="n">featureInput1</span><span class="p">))</span><span class="w">

      </span><span class="n">p</span><span class="m">2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">plot_ly</span><span class="p">(</span><span class="n">tab</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Count</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"box"</span><span class="p">,</span><span class="w"> </span><span class="n">showlegend</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">F</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
        </span><span class="n">layout</span><span class="p">(</span><span class="n">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Box plot for Malignant cases"</span><span class="p">,</span><span class="w">
               </span><span class="n">yaxis</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">list</span><span class="p">(</span><span class="n">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Count"</span><span class="p">),</span><span class="w">
               </span><span class="n">xaxis</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">list</span><span class="p">(</span><span class="n">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">input</span><span class="o">$</span><span class="n">featureInput2</span><span class="p">))</span><span class="w">

      </span><span class="n">subplot</span><span class="p">(</span><span class="n">p</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="m">2</span><span class="p">)</span><span class="w">
    </span><span class="p">}</span><span class="k">else</span><span class="p">{</span><span class="w">
      </span><span class="n">tab</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">subset</span><span class="p">(</span><span class="n">plot.summ</span><span class="p">,</span><span class="w"> </span><span class="n">Class</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"benign"</span><span class="p">)</span><span class="w">

      </span><span class="n">p</span><span class="m">1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">plot_ly</span><span class="p">(</span><span class="n">tab</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">~</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">~</span><span class="n">Count</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"box"</span><span class="p">,</span><span class="w"> </span><span class="n">showlegend</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">F</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
        </span><span class="n">layout</span><span class="p">(</span><span class="n">yaxis</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">list</span><span class="p">(</span><span class="n">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Count"</span><span class="p">),</span><span class="w">
               </span><span class="n">xaxis</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">list</span><span class="p">(</span><span class="n">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">input</span><span class="o">$</span><span class="n">featureInput1</span><span class="p">))</span><span class="w">

      </span><span class="n">p</span><span class="m">2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">plot_ly</span><span class="p">(</span><span class="n">tab</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">~</span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">~</span><span class="n">Count</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"box"</span><span class="p">,</span><span class="w"> </span><span class="n">showlegend</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">F</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
        </span><span class="n">layout</span><span class="p">(</span><span class="n">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Box plot for Benign cases"</span><span class="p">,</span><span class="w">
               </span><span class="n">yaxis</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">list</span><span class="p">(</span><span class="n">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Count"</span><span class="p">),</span><span class="w">
               </span><span class="n">xaxis</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">list</span><span class="p">(</span><span class="n">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">input</span><span class="o">$</span><span class="n">featureInput2</span><span class="p">))</span><span class="w">

      </span><span class="n">subplot</span><span class="p">(</span><span class="n">p</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="m">2</span><span class="p">)</span><span class="w">
    </span><span class="p">}</span><span class="w">

  </span><span class="p">})</span><span class="w">

</span><span class="p">}</span><span class="w">
</span></code></pre></div>